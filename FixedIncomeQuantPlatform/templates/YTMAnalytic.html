<!DOCTYPE html>
<html lang="en">

<!--<script src="/static/js/jquery-3.2.1.min.js" type="text/javascript"></script>-->
<script src="/static/js/jquery-3.2.1.min.js" type="text/javascript"></script>
<script src="/static/js/highstock.js" type="text/javascript"></script>
<script src="/static/js/drag-panes.js" type="text/javascript"></script>
<script src="/static/js/exporting.js" type="text/javascript"></script>
<script src="/static/js/highcharts-zh_CN.js" type="text/javascript"></script>
<script src="/static/js/public.js" type="text/javascript"></script>


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Highstock Example</title>

    <link href="/static/css/flexible.css" rel="stylesheet">
    <link href="/static/css/public.css" rel="stylesheet">
    <script src="/static/js/flexible.js"></script>

</head>

<body>

     <div class="div_tab_container">
         <div class="tab-group">
             <section id="tab1" title="Long Tab Name">
                     <div id="container" class="container_highstock_left">
                         Left
                     </div>
             </section>
             <section id="tab2" title="Another Tab">
                 <h3>
                     Content 2
                 </h3>
                 <p>
                     Donec congue ligula non risus dictum, eget vehicula diam mattis. Pellentesque at ante ipsum. Suspendisse rutrum elementum dolor, non congue risus sagittis id.
                 </p>
             </section>
         </div>
         <div class="tab-group">
             <section id="tab1" title="Long Tab Name">
                     <div id="container" class="container_highstock_left">
                         Left
                     </div>
             </section>
             <section id="tab2" title="Another Tab">
                 <h3>
                     Content 2
                 </h3>
                 <p>
                     Donec congue ligula non risus dictum, eget vehicula diam mattis. Pellentesque at ante ipsum. Suspendisse rutrum elementum dolor, non congue risus sagittis id.
                 </p>
             </section>
         </div>
         <div class="tab-group">
             <section id="tab1" title="Long Tab Name">
                     <div id="container" class="container_highstock_left">
                         Left
                     </div>
             </section>
             <section id="tab2" title="Another Tab">
                 <h3>
                     Content 2
                 </h3>
                 <p>
                     Donec congue ligula non risus dictum, eget vehicula diam mattis. Pellentesque at ante ipsum. Suspendisse rutrum elementum dolor, non congue risus sagittis id.
                 </p>
             </section>
         </div>
         <div class="tab-group">
             <section id="tab1" title="Long Tab Name">
                     <div id="container" class="container_highstock_left">
                         Left
                     </div>
             </section>
             <section id="tab2" title="Another Tab">
                 <h3>
                     Content 2
                 </h3>
                 <p>
                     Donec congue ligula non risus dictum, eget vehicula diam mattis. Pellentesque at ante ipsum. Suspendisse rutrum elementum dolor, non congue risus sagittis id.
                 </p>
             </section>
         </div>
     </div>
{#     <div class="combobox_container">#}
{#            <h2>Orange + Medium</h2>#}
{#         <select class="demo-3">#}
{#			  <option value="sx">初中数学</option>#}
{#			  <option value="yw">初中语文</option>#}
{#			  <option value="yy">初中英语</option>#}
{#			  <option value="wl">初中物理</option>#}
{#         </select>#}
{#     </div>#}

    <script type="text/javascript">

        $(function() {
            //进度条
            /*
                $('body').mLoading({
                    text:"申万宏源欢迎您，加载数据中",//加载文字，默认值：加载中...
                });
            */
            //加载标签栏
            $('.tab-group').tabify();
            /*
            //加载下拉框
            $('.demo-3').selectMania({
                size: 'small',
		        themes: ['orange'],
		        placeholder: 'Please select me!',
			    removable: true,
                search: true
		    });
		    */
            //加载报价数据
            loadQuotesData()

            //刷新页面，每隔10秒刷新一次数据
            //setInterval(refreshQuoteData,5000);
        });

        function loadQuotesData(){
            var url = '/FixedIncome/YTMAnalytic/loadData'
            $.ajax({
                type: 'POST',
                data:{
                },
                dataType: 'json',
                url: url,
                success: loadData,
                error: errorInfo,
                //采用异步
                async: true
            });
        }

        var loadData = function(data) {
            var seriesData = []

            //加载数据
            $.each(JSON.parse(data), function (i, item) {
                //console.log(item);
                seriesData.push([
                    str2UTC(item.timestamp),
                    parseFloat(item.bondytm)
                ])
            });
            //创建图形
            console.log(seriesData)
            createCharts(seriesData)
            //$('body').mLoading("hide");
        };

        function createCharts(data) {
            //关闭UTC时间
            Highcharts.setOptions({ global:{useUTC: false}});
            // Create the chart
            Highcharts.stockChart('container', {
                rangeSelector: {
                    selected: 0
                },
                title: {
                    text: 'USD to EUR exchange rate'
                },
                tooltip: {
                    style: {
                        width: '200px'
                    },
                    valueDecimals: 4,
                    shared: true
                },
                yAxis: {
                    title: {
                        text: 'Exchange rate'
                    }
                },
                tooltip: {
                    split: false,
                },
                series: [{
                    name: 'USD to EUR',
                    data: data,
                    id: 'dataseries'
                // the event marker flags
                }, {
                    type: 'flags',
                    data: [{}],
                    onSeries: 'dataseries',
                    shape: 'circlepin',
                    width: 16
                }]
            });
        }

        //错误信息处理界面
        var errorInfo = function(msg){
            console.log(msg);
            //关闭进度条
            //$('body').mLoading("hide");
        };

        function str2UTC(str) {
            date = new Date(Date.parse(str.replace(/-/g, "/")))
            //组成UTC
            var y =  date.getUTCFullYear();
            var m = date.getUTCMonth() ;
            var d = date.getUTCDate();
            var h= date.getUTCHours();
            var M = date.getUTCMinutes();
            var s = date.getUTCSeconds();
            //这里只选年月日，如有需要可以多选
            var utc = Date.UTC(y,m,d);
            return utc
        }
    </script>


</body>
</html>